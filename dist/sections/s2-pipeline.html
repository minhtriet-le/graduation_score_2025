    <!-- SECTION: ETL PIPELINE -->
    <a class="section-anchor" id="sec-pipeline"></a>
    <section class="section">
      <div class="section-header">
        <div class="section-icon">üîÑ</div>
        <div><div class="section-title">ETL Pipeline</div><div class="section-subtitle">Quy tr√¨nh x·ª≠ l√Ω d·ªØ li·ªáu th√¥ t·ª´ Excel ‚Üí Parquet</div></div>
        </div>

      <div class="panel">
        <span class="panel-badge blue">B∆∞·ªõc 1 ‚Äì Transform</span>
        <div class="panel-title">üîÑ Ingest & Normalize</div>
        <p class="panel-lead">Chuy·ªÉn ƒë·ªïi d·ªØ li·ªáu th√¥ t·ª´ nhi·ªÅu file <code>.xlsx</code> th√†nh ƒë·ªãnh d·∫°ng Parquet t·ªëi ∆∞u, s·∫µn s√†ng cho ph√¢n t√≠ch.</p>

        <div class="pipeline-wrap">

          <div class="pipeline-step">
            <div class="step-circle"><div class="step-num">1</div></div>
            <div class="step-body">
              <div class="step-title">ƒê·ªçc d·ªØ li·ªáu ‚Äì Multi-Sheet Scanning</div>
              <div class="step-desc">Duy·ªát t·∫•t c·∫£ file <code>.xlsx</code>, ƒë·ªçc t·ª´ng sheet v√† g·∫Øn metadata ngu·ªìn g·ªëc (<code>origin_file</code>, <code>origin_sheet</code>).</div>
              <div class="code-block"><span class="kw">for</span> file_path <span class="kw">in</span> data_dir.glob(<span class="st">"*.xlsx"</span>):
    excel_data = pd.read_excel(file_path, sheet_name=<span class="kw">None</span>)
    <span class="kw">for</span> sheet_name, df <span class="kw">in</span> excel_data.items():
        df[<span class="st">'origin_file'</span>] = file_path.name
        df[<span class="st">'origin_sheet'</span>] = <span class="fn">str</span>(sheet_name)
        all_dfs.append(df)</div>
            </div>
          </div>

          <div class="pipeline-step">
            <div class="step-circle"><div class="step-num">2</div></div>
            <div class="step-body">
              <div class="step-title">Chu·∫©n ho√° t√™n c·ªôt</div>
              <div class="step-desc">Xo√° d·∫•u, vi·∫øt th∆∞·ªùng, thay kho·∫£ng tr·∫Øng b·∫±ng d·∫•u g·∫°ch d∆∞·ªõi. V√≠ d·ª•: <em>"Tin h·ªçc" ‚Üí "tin_hoc"</em></div>
              <div class="code-block">final_df.columns = [
    unidecode(col).lower().replace(<span class="st">' '</span>, <span class="st">'_'</span>)
    <span class="kw">for</span> col <span class="kw">in</span> final_df.columns
]  <span class="cm"># "Tin h·ªçc" ‚Üí "tin_hoc"</span></div>
            </div>
          </div>

          <div class="pipeline-step">
            <div class="step-circle"><div class="step-num">3</div></div>
            <div class="step-body">
              <div class="step-title">L√†m s·∫°ch m√£ s·ªë b√°o danh (SBD)</div>
              <div class="step-desc">Lo·∫°i d√≤ng thi·∫øu SBD, chu·∫©n ho√° v·ªÅ 8 ch·ªØ s·ªë b·∫±ng zero-padding.</div>
              <div class="code-block">final_df = final_df[final_df[<span class="st">'sobaodanh'</span>].notna()]
final_df[<span class="st">'sobaodanh'</span>] = (
    final_df[<span class="st">'sobaodanh'</span>]
    .astype(<span class="fn">int</span>).astype(<span class="fn">str</span>).str.zfill(<span class="num">8</span>)
)  <span class="cm"># 12345 ‚Üí "00012345"</span></div>
            </div>
          </div>

          <div class="pipeline-step">
            <div class="step-circle"><div class="step-num">4</div></div>
            <div class="step-body">
              <div class="step-title">T·ªëi ∆∞u ki·ªÉu d·ªØ li·ªáu</div>
              <div class="step-desc">Chuy·ªÉn ƒëi·ªÉm sang <code>float32</code> ƒë·ªÉ ti·∫øt ki·ªám b·ªô nh·ªõ; gi√° tr·ªã l·ªói (ABS, b·ªè thi‚Ä¶) th√†nh <code>NaN</code>.</div>
              <div class="code-block"><span class="kw">for</span> col <span class="kw">in</span> score_cols:
    final_df[col] = pd.to_numeric(
        final_df[col], errors=<span class="st">'coerce'</span>
    ).astype(<span class="st">'float32'</span>)</div>
            </div>
          </div>

          <div class="pipeline-step">
            <div class="step-circle"><div class="step-num">5</div></div>
            <div class="step-body">
              <div class="step-title">G·∫Øn m√£ t·ªânh & s√°p nh·∫≠p t·ªânh m·ªõi</div>
              <div class="step-desc">Tr√≠ch 2 k√Ω t·ª± ƒë·∫ßu SBD l√†m m√£ t·ªânh (<code>ma_tinh</code>), map sang t√™n t·ªânh g·ªëc v√† t·ªânh m·ªõi sau s√°p nh·∫≠p 2025.</div>
            </div>
          </div>

          <div class="pipeline-step">
            <div class="step-circle"><div class="step-num">6</div></div>
            <div class="step-body">
              <div class="step-title">Xu·∫•t Parquet</div>
              <div class="step-desc">S·∫Øp x·∫øp theo SBD, l∆∞u b·∫±ng engine PyArrow ‚Äì nhanh, n√©n t·ªët, h·ªó tr·ª£ ki·ªÉu d·ªØ li·ªáu ph·ª©c t·∫°p.</div>
              <div class="code-block">final_df = final_df.sort_values(<span class="st">'sobaodanh'</span>)
final_df.to_parquet(output_filename,
    engine=<span class="st">'pyarrow'</span>, index=<span class="kw">False</span>)</div>
            </div>
          </div>

        </div>
      </div>

      <div class="panel">
        <span class="panel-badge green">B∆∞·ªõc 2 ‚Äì Ph√¢n t√≠ch</span>
        <div class="panel-title">üìä Visualization Pipeline</div>
        <p class="panel-lead">ƒê·ªçc file Parquet ƒë√£ chu·∫©n ho√°, th·ª±c hi·ªán th·ªëng k√™ m√¥ t·∫£ v√† tr·ª±c quan ho√° ph√¢n ph·ªëi ƒëi·ªÉm t·ª´ng m√¥n.</p>

        <div class="tab-bar" data-target="tab-group-analysis">
          <button class="tab-btn" data-pane="tab-stats">Th·ªëng k√™ m√¥ t·∫£</button>
          <button class="tab-btn" data-pane="tab-charts">Bi·ªÉu ƒë·ªì ph√¢n ph·ªëi</button>
          <button class="tab-btn" data-pane="tab-cluster">Ph√¢n c·ª•m</button>
          <button class="tab-btn" data-pane="tab-test">Ki·ªÉm ƒë·ªãnh</button>
        </div>

        <div id="tab-group-analysis">
          <div class="tab-pane" id="tab-stats">
            <p>T√≠nh mean, median, std, skewness, kurtosis theo t·ª´ng m√¥n thi tr√™n to√†n qu·ªëc. ƒê√°nh gi√° theo <em>ng∆∞·ª°ng v√†ng</em> IRT: mean ‚âà 5.0 ‚Äì 5.5, SD = 1.6 ‚Äì 2.0.</p>
          </div>
          <div class="tab-pane" id="tab-charts">
            <p>V·∫Ω histogram ph√¢n ph·ªëi ƒëi·ªÉm (bin width = 0.5 ƒëi·ªÉm), annotate th·ªëng k√™ tr·ª±c ti·∫øp tr√™n bi·ªÉu ƒë·ªì. Xu·∫•t PNG 120 DPI v√†o th∆∞ m·ª•c <code>charts/</code>.</p>
          </div>
          <div class="tab-pane" id="tab-cluster">
            <p>K-Means clustering v·ªõi StandardScaler, ch·ªçn K t·ªëi ∆∞u qua Elbow Method + Silhouette Score. √Åp d·ª•ng cho t·ª´ng m√¥n ƒë∆°n, kh·ªëi T·ª± Nhi√™n (To√°n+L√Ω+H√≥a), kh·ªëi X√£ H·ªôi (VƒÉn+S·ª≠+ƒê·ªãa) v√† theo t·ªânh sau s√°p nh·∫≠p.</p>
          </div>
          <div class="tab-pane" id="tab-test">
            <p>Ki·ªÉm ƒë·ªãnh Levene ‚Üí Welch's t-test (hai ph√≠a, Œ± = 0.05). T√≠nh Cohen's d (effect size) v√† Mann-Whitney U test (phi tham s·ªë). Case study: Qu·∫£ng Nam vs ƒê√† N·∫µng.</p>
          </div>
        </div>
      </div>
    </section>
